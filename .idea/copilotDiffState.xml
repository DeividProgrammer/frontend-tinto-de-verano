<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/app/controllers/session.js">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/controllers/session.js" />
              <option name="originalContent" value="import Controller from '@ember/controller';&#10;import { tracked } from '@glimmer/tracking';&#10;import { action } from '@ember/object';&#10;import { inject as service } from '@ember/service';&#10;&#10;export default class SessionController extends Controller {&#10;  @service router;&#10;  @service session;&#10;&#10;  @tracked email = '';&#10;  @tracked password = '';&#10;  @tracked errorMessage = null;&#10;  @tracked isAuthenticating = false;&#10;&#10;  @action&#10;  updateEmail(event) {&#10;    this.email = event.target.value;&#10;  }&#10;&#10;  @action&#10;  updatePassword(event) {&#10;    this.password = event.target.value;&#10;  }&#10;&#10;  @action&#10;  async login(event) {&#10;    event.preventDefault();&#10;&#10;    this.errorMessage = null;&#10;    this.isAuthenticating = true;&#10;&#10;    try {&#10;      const response = await fetch('/session', {&#10;        method: 'POST',&#10;        headers: {&#10;          'Content-Type': 'application/vnd.api+json',&#10;          Accept: 'application/vnd.api+json',&#10;        },&#10;        credentials: 'include',&#10;        body: JSON.stringify({&#10;          data: {&#10;            type: 'sessions',&#10;            attributes: {&#10;              email: this.email,&#10;              password: this.password,&#10;            },&#10;          },&#10;        }),&#10;      });&#10;&#10;      if (!response.ok) {&#10;        let errorText;&#10;        try {&#10;          const errorJson = await response.json();&#10;          errorText = errorJson.errors?.[0]?.detail || response.statusText;&#10;        } catch (parseError) {&#10;          console.error('Login response parsing error:', parseError);&#10;          errorText = response.statusText;&#10;        }&#10;        throw new Error(errorText || 'Login error');&#10;      }&#10;&#10;      const data = await response.json();&#10;      console.log('Correct Login, server response:', data);&#10;&#10;      this.session.setSession(data.data);&#10;&#10;      this.router.transitionTo('me');&#10;    } catch (err) {&#10;      console.error('Login error:', err);&#10;      this.errorMessage = err.message || &quot;It wasn't possible to log in.&quot;;&#10;      this.password = '';&#10;    } finally {&#10;      this.isAuthenticating = false;&#10;    }&#10;  }&#10;}&#10;" />
              <option name="updatedContent" value="import Controller from '@ember/controller';&#10;import { tracked } from '@glimmer/tracking';&#10;import { action } from '@ember/object';&#10;import { inject as service } from '@ember/service';&#10;&#10;export default class SessionController extends Controller {&#10;  @service router;&#10;  @service session;&#10;&#10;  @tracked email = '';&#10;  @tracked password = '';&#10;  @tracked errorMessage = null;&#10;  @tracked isAuthenticating = false;&#10;&#10;  @action&#10;  updateEmail(event) {&#10;    this.email = event.target.value;&#10;  }&#10;&#10;  @action&#10;  updatePassword(event) {&#10;    this.password = event.target.value;&#10;  }&#10;&#10;  @action&#10;  async login(event) {&#10;    event.preventDefault();&#10;&#10;    this.errorMessage = null;&#10;    this.isAuthenticating = true;&#10;&#10;    try {&#10;      const response = await fetch('/session', {&#10;        method: 'POST',&#10;        headers: {&#10;          'Content-Type': 'application/vnd.api+json',&#10;          Accept: 'application/vnd.api+json',&#10;        },&#10;        credentials: 'include',&#10;        body: JSON.stringify({&#10;          data: {&#10;            type: 'sessions',&#10;            attributes: {&#10;              email: this.email,&#10;              password: this.password,&#10;            },&#10;          },&#10;        }),&#10;      });&#10;&#10;      if (!response.ok) {&#10;        let errorText;&#10;        try {&#10;          const errorJson = await response.json();&#10;          errorText = errorJson.errors?.[0]?.detail || response.statusText;&#10;        } catch (parseError) {&#10;          console.error('Login response parsing error:', parseError);&#10;          errorText = response.statusText;&#10;        }&#10;        throw new Error(errorText || 'Login error');&#10;      }&#10;&#10;      const data = await response.json();&#10;      console.log('Correct Login, server response:', data);&#10;&#10;      this.session.setSession(data.data);&#10;&#10;      this.router.transitionTo('me');&#10;    } catch (err) {&#10;      console.error('Login error:', err);&#10;      this.errorMessage = err.message || &quot;It wasn't possible to log in.&quot;;&#10;      this.password = '';&#10;    } finally {&#10;      this.isAuthenticating = false;&#10;    }&#10;  }&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/routes/me.js">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/routes/me.js" />
              <option name="originalContent" value="import Route from '@ember/routing/route';&#10;import { inject as service } from '@ember/service';&#10;import RSVP from 'rsvp';&#10;&#10;export default class MeRoute extends Route {&#10;  @service session;&#10;  @service router;&#10;  @service store;&#10;&#10;  beforeModel(transition) {&#10;    if (!this.session.isAuthenticated) {&#10;      this.router.transitionTo('session');&#10;    }&#10;  }&#10;&#10;  async model() {&#10;    const response = await RSVP.hash({&#10;      user: this.store.findRecord('user', 'me'),&#10;&#10;      counter: fetch('http://localhost:8888/me/counter', {&#10;        method: 'GET',&#10;        headers: {&#10;          'Content-Type': 'application/vnd.api+json',&#10;          Accept: 'application/vnd.api+json',&#10;        },&#10;        credentials: 'include',&#10;      }).then((response) =&gt; {&#10;        if (response.ok) {&#10;          return response.json();&#10;        } else {&#10;          this.router.transitionTo('session');&#10;        }&#10;      }),&#10;    });&#10;&#10;    return response;&#10;  }&#10;}&#10;&#10;" />
              <option name="updatedContent" value="import Route from '@ember/routing/route';&#10;import { inject as service } from '@ember/service';&#10;import RSVP from 'rsvp';&#10;&#10;export default class MeRoute extends Route {&#10;  @service session;&#10;  @service router;&#10;  @service store;&#10;&#10;  beforeModel(transition) {&#10;    if (!this.session.isAuthenticated) {&#10;      this.router.transitionTo('session');&#10;    }&#10;  }&#10;&#10;  async model() {&#10;    const response = await RSVP.hash({&#10;      user: this.store.findRecord('user', 'me'),&#10;&#10;      counter: fetch('http://localhost:8888/me/counter', {&#10;        method: 'GET',&#10;        headers: {&#10;          'Content-Type': 'application/vnd.api+json',&#10;          Accept: 'application/vnd.api+json',&#10;        },&#10;        credentials: 'include',&#10;      }).then((response) =&gt; {&#10;        if (response.ok) {&#10;          return response.json();&#10;        } else {&#10;          this.router.transitionTo('session');&#10;        }&#10;      }),&#10;    });&#10;&#10;    return response;&#10;  }&#10;}&#10;&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>